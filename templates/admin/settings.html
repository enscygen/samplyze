{% extends "layout.html" %}
{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
    <h1 class="h2">Laboratory Settings</h1>
</div>

<form method="POST" action="" enctype="multipart/form-data" novalidate>
    {{ form.hidden_tag() }}
    <div class="row">
        <!-- Card 1: Core Laboratory Identity -->
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header">
                    <h5 class="mb-0"><i class="bi bi-building me-2"></i>Core Laboratory Identity</h5>
                </div>
                <div class="card-body">
                    <p class="card-text text-muted small">Basic information that identifies your laboratory.</p>
                    <div class="mb-3">
                        {{ form.lab_name.label(class="form-label") }}
                        {{ form.lab_name(class="form-control") }}
                    </div>
                    <div class="mb-3">
                        {{ form.description.label(class="form-label") }}
                        {{ form.description(class="form-control", rows=2) }}
                    </div>
                    <div class="mb-3">
                        {{ form.address.label(class="form-label") }}
                        {{ form.address(class="form-control", rows=3) }}
                    </div>
                </div>
            </div>
        </div>

        <!-- Card 2: Contact & Web Presence -->
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header">
                    <h5 class="mb-0"><i class="bi bi-globe2 me-2"></i>Contact & Web Presence</h5>
                </div>
                <div class="card-body">
                    <p class="card-text text-muted small">How clients can contact you and verify reports online.</p>
                    <div class="row">
                        <div class="col-md-6 mb-3">{{ form.contact_number.label(class="form-label") }}{{ form.contact_number(class="form-control") }}</div>
                        <div class="col-md-6 mb-3">{{ form.email.label(class="form-label") }}{{ form.email(class="form-control") }}</div>
                    </div>
                    <div class="mb-3">
                        {{ form.website_url.label(class="form-label") }}
                        {{ form.website_url(class="form-control") }}
                    </div>
                    <div class="mb-3">
                        {{ form.verification_url.label(class="form-label") }}
                        {{ form.verification_url(class="form-control") }}
                    </div>
                </div>
            </div>
        </div>

        <!-- Card 3: Branding & Logos -->
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header">
                    <h5 class="mb-0"><i class="bi bi-image me-2"></i>Branding & Logos</h5>
                </div>
                <div class="card-body">
                    <p class="card-text text-muted small">Upload logos for reports and the application's navigation bar.</p>
                    <div class="row align-items-center mb-3">
                        <div class="col-md-4 text-center">
                             <h6>Main Report Logo</h6>
                             {% if settings and settings.logo_path %}<img src="{{ url_for('uploaded_file', filename=settings.logo_path) }}" class="img-fluid rounded border" alt="Current Logo">{% else %}<div class="text-muted">None</div>{% endif %}
                        </div>
                        <div class="col-md-8">{{ form.logo.label(class="form-label") }}{{ form.logo(class="form-control") }}</div>
                    </div>
                    <hr>
                    <div class="row align-items-center">
                        <div class="col-md-4 text-center">
                             <h6>Navbar Logo</h6>
                             {% if settings and settings.nav_logo_path %}<img src="{{ url_for('uploaded_file', filename=settings.nav_logo_path) }}" class="img-fluid rounded border navbar-logo-settings-display" alt="Current Navbar Logo">{% else %}<div class="text-muted">None</div>{% endif %}
                        </div>
                        <div class="col-md-8">{{ form.navlogo.label(class="form-label") }}{{ form.navlogo(class="form-control") }}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Card 4: Display Preferences -->
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header">
                    <h5 class="mb-0"><i class="bi bi-display me-2"></i>Display Preferences</h5>
                </div>
                <div class="card-body">
                    <p class="card-text text-muted small">Control how your lab's name is displayed throughout the application.</p>
                    <div class="mb-3">
                        <div class="form-check form-switch">
                            {{ form.show_name_in_navbar(class="form-check-input") }}
                            {{ form.show_name_in_navbar.label(class="form-check-label") }}
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="form-check form-switch">
                            {{ form.show_name_in_reports(class="form-check-input") }}
                            {{ form.show_name_in_reports.label(class="form-check-label") }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center mt-4">
        {{ form.submit(class="btn btn-primary btn-lg") }}
    </div>
</form>
{% endblock %}
